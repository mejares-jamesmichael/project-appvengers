import{a as A}from"./chunk-PUHZP2ZX.js";import{a as q,c as G}from"./chunk-ZUJZEK4Q.js";import{a as x}from"./chunk-PZSFEQ4E.js";import{a as N,b as f,c as E,d as F,g as k,j as T,k as D,q as O,s as V}from"./chunk-DUKZIXU3.js";import"./chunk-PHYEHXVE.js";import{Ba as h,C as _,Da as s,E as y,F as b,Fa as S,L as c,R as n,X as v,ea as l,fa as u,gb as C,ka as g,la as t,ma as i,na as d,ta as P,ua as p,va as w,zb as M}from"./chunk-4MU7JTCM.js";function B(r,a){if(r&1){let o=P();t(0,"div",8),s(1),t(2,"button",24),p("click",function(){y(o);let m=w();return b(m.successMessage.set(null))}),i()()}if(r&2){let o=w();n(),S(" ",o.successMessage()," ")}}function I(r,a){if(r&1){let o=P();t(0,"div",9),s(1),t(2,"button",24),p("click",function(){y(o);let m=w();return b(m.errorMessage.set(null))}),i()()}if(r&2){let o=w();n(),S(" ",o.errorMessage()," ")}}function j(r,a){r&1&&(t(0,"span",15),s(1," Current Password is required. "),i())}function H(r,a){r&1&&(t(0,"span",15),s(1," New Password is required. "),i())}function R(r,a){r&1&&(t(0,"span",15),s(1," Password must be at least 8 characters. "),i())}function z(r,a){r&1&&(t(0,"span",15),s(1," Confirm Password is required. "),i())}function J(r,a){r&1&&(d(0,"span",25),s(1," Saving... "))}function K(r,a){r&1&&s(0," Save ")}var L=class r{securitySettingsForm;formBuilder=_(O);authService=_(x);hideCurrentPassword=c(!0);hideNewPassword=c(!0);hideConfirmPassword=c(!0);isSubmitting=c(!1);successMessage=c(null);errorMessage=c(null);constructor(){this.securitySettingsForm=this.formBuilder.group({current_password:["",{validators:[f.required]}],new_password:["",{validators:[f.required,f.minLength(8)]}],confirm_password:["",{validators:[f.required]}]})}get currentPassword(){return this.securitySettingsForm.get("current_password")}get newPassword(){return this.securitySettingsForm.get("new_password")}get confirmPassword(){return this.securitySettingsForm.get("confirm_password")}onSubmit(){if(this.successMessage.set(null),this.errorMessage.set(null),this.securitySettingsForm.invalid){Object.keys(this.securitySettingsForm.controls).forEach(e=>{this.securitySettingsForm.get(e)?.markAsTouched()});return}let a=this.securitySettingsForm.value;if(a.new_password!==a.confirm_password){this.errorMessage.set("New password and confirm password do not match");return}this.isSubmitting.set(!0);let o={currentPassword:a.current_password,newPassword:a.new_password,confirmPassword:a.confirm_password};this.authService.changePassword(o).subscribe({next:e=>{this.isSubmitting.set(!1),e.success?(this.successMessage.set(e.message),this.securitySettingsForm.reset()):this.errorMessage.set(e.message)},error:e=>{this.isSubmitting.set(!1),this.errorMessage.set(e.error?.message||"Failed to change password. Please try again.")}})}static \u0275fac=function(o){return new(o||r)};static \u0275cmp=v({type:r,selectors:[["app-security"]],decls:56,vars:24,consts:[[1,"third-panel"],[1,"info-container"],[1,"fw-semibold"],[1,"text-muted"],[1,"card","security-settings-panel"],[1,"card-header","p-4"],[1,"fw-semibold","m-0"],[1,"card-body"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"security-form-wrapper",3,"ngSubmit","formGroup"],[1,"input-group"],["formControlName","current_password","placeholder","Current Password",1,"form-control",3,"type"],[1,"btn","btn-outline-secondary",3,"click"],[1,"bi"],[1,"text-danger","small","mt-1"],["formControlName","new_password","placeholder","New Password","type","password",1,"form-control",3,"type"],["formControlName","confirm_password","placeholder","Confirm Password","type","password",1,"form-control",3,"type"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"privacy-panel"],[1,"card"],[1,"card-header","p-3"],["type","button","routerLink","/",1,"btn","btn-sm","btn-secondary"],["type","button","routerLink","/",1,"btn","btn-sm","btn-danger"],["type","button",1,"btn-close",3,"click"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"]],template:function(o,e){o&1&&(d(0,"app-sidebar")(1,"app-header")(2,"app-sub-header"),t(3,"main")(4,"div",0)(5,"div",1)(6,"h5",2),s(7,"Security"),i(),t(8,"p",3),s(9," Manage your password and privacy settings. "),i()()(),t(10,"div",4)(11,"div",5)(12,"h6",6),s(13,"Password"),i()(),t(14,"div",7),l(15,B,3,1,"div",8),l(16,I,3,1,"div",9),t(17,"form",10),p("ngSubmit",function(){return e.onSubmit()}),t(18,"div")(19,"label"),s(20,"Current Password"),i(),t(21,"div",11),d(22,"input",12),t(23,"button",13),p("click",function(){return e.hideCurrentPassword.set(!e.hideCurrentPassword())}),d(24,"i",14),i()(),l(25,j,2,0,"span",15),i(),t(26,"div")(27,"label"),s(28,"New Password"),i(),t(29,"div",11),d(30,"input",16),t(31,"button",13),p("click",function(){return e.hideNewPassword.set(!e.hideNewPassword())}),d(32,"i",14),i()(),l(33,H,2,0,"span",15),l(34,R,2,0,"span",15),i(),t(35,"div")(36,"label"),s(37,"Confirm Password"),i(),t(38,"div",11),d(39,"input",17),t(40,"button",13),p("click",function(){return e.hideConfirmPassword.set(!e.hideConfirmPassword())}),d(41,"i",14),i()(),l(42,z,2,0,"span",15),i(),t(43,"button",18),l(44,J,2,0)(45,K,1,0),i()()()(),t(46,"div",19)(47,"div",20)(48,"div",21)(49,"h5"),s(50,"Privacy"),i()(),t(51,"div",7)(52,"button",22),s(53," Deactivate Account "),i(),t(54,"button",23),s(55," Delete Account "),i()()()()()),o&2&&(n(15),u(e.successMessage()?15:-1),n(),u(e.errorMessage()?16:-1),n(),g("formGroup",e.securitySettingsForm),n(5),g("type",e.hideCurrentPassword()?"password":"text"),n(2),h("bi-eye",!e.hideCurrentPassword())("bi-eye-slash",e.hideCurrentPassword()),n(),u(!(e.currentPassword==null||e.currentPassword.errors==null)&&e.currentPassword.errors.required&&(e.currentPassword!=null&&e.currentPassword.touched)?25:-1),n(5),g("type",e.hideNewPassword()?"password":"text"),n(2),h("bi-eye",!e.hideNewPassword())("bi-eye-slash",e.hideNewPassword()),n(),u(!(e.newPassword==null||e.newPassword.errors==null)&&e.newPassword.errors.required&&(e.newPassword!=null&&e.newPassword.touched)?33:-1),n(),u(!(e.newPassword==null||e.newPassword.errors==null)&&e.newPassword.errors.minlength&&(e.newPassword!=null&&e.newPassword.touched)?34:-1),n(5),g("type",e.hideConfirmPassword()?"password":"text"),n(2),h("bi-eye",!e.hideConfirmPassword())("bi-eye-slash",e.hideConfirmPassword()),n(),u(!(e.confirmPassword==null||e.confirmPassword.errors==null)&&e.confirmPassword.errors.required&&(e.confirmPassword!=null&&e.confirmPassword.touched)?42:-1),n(),g("disabled",e.isSubmitting()||e.securitySettingsForm.invalid),n(),u(e.isSubmitting()?44:45))},dependencies:[q,G,V,k,N,E,F,T,D,A,M,C],styles:['main[_ngcontent-%COMP%]{margin-left:100px;background-color:#e8e9eb;height:auto;min-height:100vh;padding:30px 120px;display:grid;grid-template-areas:"third-panel third-panel" "security-settings-panel privacy-panel";gap:1em}.privacy-panel[_ngcontent-%COMP%]{grid-area:privacy-panel}.privacy-panel[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1em}.security-settings-panel[_ngcontent-%COMP%]{grid-area:security-settings-panel}.third-panel[_ngcontent-%COMP%]{grid-area:third-panel;margin-top:2%}.security-form-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:15px;gap:1em}.card[_ngcontent-%COMP%]{box-sizing:border-box;width:100%;max-width:100%}@media (max-width: 320px){main[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-left:10px;padding-right:10px;margin-left:0}}@media (min-width: 321px) and (max-width: 768px){main[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-left:20px;padding-right:20px;margin-left:0}}@media (min-width: 769px) and (max-width: 1024px){main[_ngcontent-%COMP%]{padding-left:50px;padding-right:50px;grid-template-areas:"third-panel" "security-settings-panel" "privacy-panel"}}@media (max-width: 1025px){.third-panel[_ngcontent-%COMP%]{height:5px!important}}']})};export{L as Security};
