import{a as E}from"./chunk-PZSFEQ4E.js";import{a as R,b as C,c as N,d as F,g as V,j as T,k as I,q as D,s as L}from"./chunk-DUKZIXU3.js";import"./chunk-PHYEHXVE.js";import{Ba as P,Da as o,E as f,Ea as M,F as _,Fa as h,L as l,R as s,W as g,X as x,ea as m,fa as u,gb as O,ka as p,la as t,ma as n,na as a,ta as v,ua as b,va as w,wb as y,yb as S,zb as k}from"./chunk-4MU7JTCM.js";function q(r,i){r&1&&(t(0,"div",9)(1,"div",13)(2,"span",14),o(3,"Loading..."),n()(),t(4,"p",15),o(5,"Validating reset link..."),n()())}function G(r,i){if(r&1&&(t(0,"div",10)(1,"div",16),a(2,"i",17),n(),t(3,"h5",18),o(4,"Invalid or Expired Link"),n(),t(5,"p",19),o(6),n(),t(7,"a",20),o(8," Request New Reset Link "),n(),t(9,"div",4)(10,"a",21),a(11,"i",22),o(12," Back to Login "),n()()()),r&2){let e=w();s(6),h(" ",e.errorMessage()," ")}}function z(r,i){if(r&1&&(t(0,"div",11)(1,"div",23),a(2,"i",24),n(),t(3,"h5",18),o(4,"Password Reset Successful!"),n(),t(5,"p",19),o(6),n(),t(7,"p",25),o(8," Redirecting to login page... "),n(),t(9,"a",26),o(10," Go to Login "),n()()),r&2){let e=w();s(6),h(" ",e.successMessage()," ")}}function B(r,i){if(r&1&&(t(0,"div",28),o(1),n()),r&2){let e=w(2);s(),M(e.errorMessage())}}function j(r,i){r&1&&(t(0,"div",34),o(1," Password is required "),n())}function Y(r,i){r&1&&(t(0,"div",34),o(1," Password must be at least 8 characters "),n())}function H(r,i){r&1&&(t(0,"div",34),o(1," Please confirm your password "),n())}function J(r,i){r&1&&(t(0,"div",34),o(1," Passwords do not match "),n())}function K(r,i){r&1&&(a(0,"span",38),o(1," Resetting Password... "))}function Q(r,i){r&1&&o(0," Reset Password ")}function U(r,i){if(r&1){let e=v();t(0,"form",27),b("ngSubmit",function(){f(e);let c=w();return _(c.onSubmit())}),m(1,B,2,1,"div",28),t(2,"div",18)(3,"label",29),o(4,"New Password"),n(),t(5,"div",30),a(6,"input",31),t(7,"button",32),b("click",function(){f(e);let c=w();return _(c.hideNewPassword.set(!c.hideNewPassword()))}),a(8,"i",33),n()(),m(9,j,2,0,"div",34),m(10,Y,2,0,"div",34),n(),t(11,"div",18)(12,"label",35),o(13,"Confirm Password"),n(),t(14,"div",30),a(15,"input",36),t(16,"button",32),b("click",function(){f(e);let c=w();return _(c.hideConfirmPassword.set(!c.hideConfirmPassword()))}),a(17,"i",33),n()(),m(18,H,2,0,"div",34),m(19,J,2,0,"div",34),n(),t(20,"button",37),m(21,K,2,0)(22,Q,1,0),n(),t(23,"div",4)(24,"a",21),a(25,"i",22),o(26," Back to Login "),n()()()}if(r&2){let e=w();p("formGroup",e.resetPasswordForm),s(),u(e.errorMessage()?1:-1),s(5),P("is-invalid",(e.newPassword==null?null:e.newPassword.invalid)&&(e.newPassword==null?null:e.newPassword.touched)),p("type",e.hideNewPassword()?"password":"text"),s(2),P("bi-eye",!e.hideNewPassword())("bi-eye-slash",e.hideNewPassword()),s(),u(e.newPassword!=null&&e.newPassword.hasError("required")&&(e.newPassword!=null&&e.newPassword.touched)?9:-1),s(),u(e.newPassword!=null&&e.newPassword.hasError("minlength")&&(e.newPassword!=null&&e.newPassword.touched)?10:-1),s(5),P("is-invalid",(e.confirmPassword==null?null:e.confirmPassword.invalid)&&(e.confirmPassword==null?null:e.confirmPassword.touched)||e.resetPasswordForm.hasError("passwordMismatch")),p("type",e.hideConfirmPassword()?"password":"text"),s(2),P("bi-eye",!e.hideConfirmPassword())("bi-eye-slash",e.hideConfirmPassword()),s(),u(e.confirmPassword!=null&&e.confirmPassword.hasError("required")&&(e.confirmPassword!=null&&e.confirmPassword.touched)?18:-1),s(),u(e.resetPasswordForm.hasError("passwordMismatch")&&(e.confirmPassword!=null&&e.confirmPassword.touched)?19:-1),s(),p("disabled",e.submitting()||e.resetPasswordForm.invalid),s(),u(e.submitting()?21:22)}}var A=class r{constructor(i,e,d,c){this.fb=i;this.authService=e;this.route=d;this.router=c;this.resetPasswordForm=this.fb.group({newPassword:["",[C.required,C.minLength(8)]],confirmPassword:["",[C.required]]},{validators:this.passwordMatchValidator})}resetPasswordForm;token=l("");tokenValid=l(!1);loading=l(!0);submitting=l(!1);errorMessage=l("");successMessage=l("");hideNewPassword=l(!0);hideConfirmPassword=l(!0);ngOnInit(){this.route.queryParams.subscribe(i=>{let e=i.token;e?(this.token.set(e),this.validateToken(e)):(this.loading.set(!1),this.errorMessage.set("Invalid password reset link"))})}passwordMatchValidator(i){let e=i.get("newPassword"),d=i.get("confirmPassword");return!e||!d||e.value===d.value?null:{passwordMismatch:!0}}get newPassword(){return this.resetPasswordForm.get("newPassword")}get confirmPassword(){return this.resetPasswordForm.get("confirmPassword")}validateToken(i){this.authService.validateResetToken(i).subscribe({next:e=>{this.tokenValid.set(e.success),this.loading.set(!1),e.success||this.errorMessage.set(e.message)},error:e=>{this.tokenValid.set(!1),this.loading.set(!1),this.errorMessage.set(e.error?.message||"Invalid or expired reset token")}})}onSubmit(){if(this.resetPasswordForm.invalid)return;this.submitting.set(!0),this.errorMessage.set("");let i={token:this.token(),newPassword:this.resetPasswordForm.value.newPassword,confirmPassword:this.resetPasswordForm.value.confirmPassword};this.authService.resetPassword(i).subscribe({next:e=>{this.submitting.set(!1),e.success?(this.successMessage.set(e.message),setTimeout(()=>{this.router.navigate(["/login"])},3e3)):this.errorMessage.set(e.message)},error:e=>{this.submitting.set(!1),this.errorMessage.set(e.error?.message||"Failed to reset password. Please try again.")}})}static \u0275fac=function(e){return new(e||r)(g(D),g(E),g(y),g(S))};static \u0275cmp=x({type:r,selectors:[["app-reset-password"]],decls:15,vars:1,consts:[[1,"reset-password-container"],[1,"card","reset-password-card"],[1,"card-body"],[1,"reset-password-header","text-center","mb-4"],[1,"text-center"],[1,"fw-bold","custom-title"],["src","assets/images/ibudget_icon.png","alt","iBudget Logo"],[1,"mt-3"],[1,"text-muted"],[1,"loading-container","text-center","py-5"],[1,"error-container","text-center"],[1,"success-container","text-center"],[1,"reset-password-form",3,"formGroup"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"text-muted","mt-3"],[1,"error-icon","mb-3"],[1,"bi","bi-x-circle-fill","text-danger",2,"font-size","4rem"],[1,"mb-3"],[1,"text-muted","mb-4"],["routerLink","/forgot-password",1,"btn","btn-primary","w-100","mb-3"],["routerLink","/login",1,"text-decoration-none"],[1,"bi","bi-arrow-left","me-1"],[1,"success-icon","mb-3"],[1,"bi","bi-check-circle-fill","text-success",2,"font-size","4rem"],[1,"text-muted","small","mb-4"],["routerLink","/login",1,"btn","btn-primary","w-100"],[1,"reset-password-form",3,"ngSubmit","formGroup"],[1,"alert","alert-danger"],["for","newPassword",1,"form-label"],[1,"input-group"],["id","newPassword","formControlName","newPassword","placeholder","Enter new password",1,"form-control",3,"type"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"bi"],[1,"text-danger","small","mt-1"],["for","confirmPassword",1,"form-label"],["id","confirmPassword","formControlName","confirmPassword","placeholder","Confirm new password",1,"form-control",3,"type"],["type","submit",1,"btn","btn-primary","w-100","mb-3",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"]],template:function(e,d){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),a(6,"img",6),n()(),t(7,"h4",7),o(8,"Reset Password"),n(),t(9,"p",8),o(10," Please enter your new password below. "),n()(),m(11,q,6,0,"div",9)(12,G,13,1,"div",10)(13,z,11,1,"div",11)(14,U,27,22,"form",12),n()()()),e&2&&(s(11),u(d.loading()?11:d.tokenValid()?d.successMessage()?13:14:12))},dependencies:[O,L,V,R,N,F,T,I,k],styles:[".reset-password-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2);padding:20px}.reset-password-card[_ngcontent-%COMP%]{width:100%;max-width:450px;border:none;border-radius:15px;box-shadow:0 10px 40px #0003}.reset-password-header[_ngcontent-%COMP%]   .custom-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:60px}.reset-password-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#1f2937;font-weight:600}.reset-password-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.loading-container[_ngcontent-%COMP%]   .spinner-border[_ngcontent-%COMP%]{width:3rem;height:3rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.reset-password-form[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-weight:500;color:#4b5563;margin-bottom:.5rem}.reset-password-form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #d1d5db;border-right:none}.reset-password-form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{border-color:#667eea;box-shadow:none}.reset-password-form[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.reset-password-form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%]{border:1px solid #d1d5db;border-left:none;background-color:#f9fafb;color:#6b7280}.reset-password-form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#e5e7eb;color:#4b5563}.reset-password-form[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border:none;padding:.75rem;font-weight:600;border-radius:8px;transition:transform .2s}.reset-password-form[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 12px #667eea66}.reset-password-form[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.success-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]{padding:2rem 0}.success-container[_ngcontent-%COMP%]   .success-icon[_ngcontent-%COMP%], .success-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .success-icon[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_scaleIn .3s ease-out}.success-container[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:#1f2937;font-weight:600}.success-container[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border:none;padding:.75rem;font-weight:600;border-radius:8px;transition:transform .2s}.success-container[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover, .error-container[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 12px #667eea66}.alert-danger[_ngcontent-%COMP%]{border-radius:8px;font-size:14px}@keyframes _ngcontent-%COMP%_scaleIn{0%{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}@media (max-width: 576px){.reset-password-card[_ngcontent-%COMP%]{margin:10px}.reset-password-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.25rem}}"]})};export{A as ResetPassword};
