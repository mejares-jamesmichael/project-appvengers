import{a as C}from"./chunk-LN244XIN.js";import{a as at}from"./chunk-BCPFIAH6.js";import{a as nt,c as it}from"./chunk-ZUJZEK4Q.js";import"./chunk-PZSFEQ4E.js";import{a as V,b as d,c as N,d as k,g as A,h as F,j as R,k as H,l as U,m as q,n as B,o as P,q as L,s as G}from"./chunk-DUKZIXU3.js";import"./chunk-PHYEHXVE.js";import{C as p,Da as a,E as g,Ea as M,F as v,Fa as $,L as m,Na as Z,R as c,X as h,Xa as O,Ya as E,ea as W,fa as j,h as T,ia as K,ja as X,ka as S,la as i,ma as n,na as _,ta as b,ua as u,va as D,wa as x,wb as w,xa as y,y as J,ya as I,yb as tt,zb as et}from"./chunk-4MU7JTCM.js";var f=class s{STATIC_HISTORY=[{transaction_id:1,savings_id:1,user_id:1,transaction_date:"2025-11-20",savings_action:"Deposit",date:new Date("2025-11-20"),description:"Remaining Allowance",amount:300,created_at:"2025-11-20",updated_at:"2025-11-20",deleted_at:""},{transaction_id:2,savings_id:1,user_id:1,transaction_date:"2025-11-20",savings_action:"Deposit",date:new Date("2025-11-20"),description:"Remaining Allowance",amount:100,created_at:"2025-11-20",updated_at:"2025-11-20",deleted_at:""},{transaction_id:3,savings_id:2,user_id:1,transaction_date:"2025-11-21",savings_action:"Deposit",date:new Date("2025-11-21"),description:"Remaining Allowance",amount:100,created_at:"2025-11-21",updated_at:"2025-11-21",deleted_at:""},{transaction_id:4,savings_id:2,user_id:1,transaction_date:"2025-11-22",savings_action:"Withdrawal",date:new Date("2025-11-22"),description:"Remaining Allowance",amount:100,created_at:"2025-11-22",updated_at:"2025-11-22",deleted_at:""},{transaction_id:5,savings_id:4,user_id:1,transaction_date:"2025-11-25",savings_action:"Deposit",date:new Date("2025-11-25"),description:"Income from Work",amount:200,created_at:"2025-11-25",updated_at:"2025-11-25",deleted_at:""}];getStaticHistory(){return T(this.STATIC_HISTORY)}getSavingTransactionsBySavingId(e,t){let o=this.STATIC_HISTORY.filter(r=>r.savings_id===e&&r.transaction_id===t);return T(o)}addSavingTransaction(e){return this.STATIC_HISTORY=[...this.STATIC_HISTORY,e],T(e)}updateSavingTransaction(e,t,o){let r=this.STATIC_HISTORY.findIndex(l=>l.savings_id===e&&l.transaction_id===t);if(r!==-1)return this.STATIC_HISTORY[r]=o,T(o);throw new Error("Transaction not found")}deleteSavingTransaction(e,t){return this.STATIC_HISTORY=this.STATIC_HISTORY.filter(o=>!(o.savings_id===e&&o.transaction_id===t)),T(this.STATIC_HISTORY)}static \u0275fac=function(t){return new(t||s)};static \u0275prov=J({token:s,factory:s.\u0275fac,providedIn:"root"})};var dt=["addSavingTransactionModal"],ct=["openSavingTransactionModalBtn"],Q=class s{addSavingTransactionModal;openSavingTransactionModalBtn;transactionForm;formBuilder=p(L);activatedRoute=p(w);historyService=p(f);transactionsLength=E(0);addedTransaction=O();tempUserId=m(1);savingId=m(1);transactionId=m(0);date=m(new Date().toISOString().split("T")[0]);constructor(){this.transactionForm=this.formBuilder.group({transaction_id:[""],saving_id:[""],user_id:[""],amount:[0,{validators:[d.required]}],savings_action:["",{validators:[d.required]}],transaction_date:["",{validators:[d.required]}],description:[""],created_at:["",{validators:[d.required]}],updated_at:["",{validators:[d.required]}],deleted_at:[""]})}ngOnInit(){let e=this.activatedRoute.snapshot.paramMap.get("id")??"";this.savingId.set(+e),this.transactionForm=this.formBuilder.group({transaction_id:[],savings_id:[+e],user_id:[this.tempUserId()],amount:[0,{validators:[d.required]}],savings_action:["",{validators:[d.required]}],transaction_date:[this.date(),{validators:[d.required]}],description:[""],created_at:[this.date(),{validators:[d.required]}],updated_at:[this.date(),{validators:[d.required]}],deleted_at:[""]})}openModal(){let e=new C(this.addSavingTransactionModal.nativeElement),t=this.transactionsLength()+1;this.transactionId.set(t),this.transactionForm.patchValue({transaction_id:t,savings_id:this.savingId()}),e.show()}closeModal(){C.getInstance(this.addSavingTransactionModal.nativeElement)?.hide(),this.transactionForm.reset({transaction_id:"",savings_id:this.savingId(),user_id:this.tempUserId(),amount:0,savings_action:"",transaction_date:this.date(),description:"",created_at:this.date(),updated_at:this.date(),deleted_at:""}),this.openSavingTransactionModalBtn.nativeElement.focus()}addSavingTransaction(){let e=this.transactionForm.value;this.historyService.addSavingTransaction(e).subscribe(t=>{this.addedTransaction.emit(t),this.closeModal()})}static \u0275fac=function(t){return new(t||s)};static \u0275cmp=h({type:s,selectors:[["app-add-saving-transaction"]],viewQuery:function(t,o){if(t&1&&(x(dt,5),x(ct,5)),t&2){let r;y(r=I())&&(o.addSavingTransactionModal=r.first),y(r=I())&&(o.openSavingTransactionModalBtn=r.first)}},inputs:{transactionsLength:[1,"transactionsLength"]},outputs:{addedTransaction:"addedTransaction"},decls:39,vars:1,consts:[["addSavingTransactionModal",""],["openSavingTransactionModalBtn",""],["data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title","fs-5"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],["for","savings_action"],["formControlName","savings_action","id","savings_action",1,"form-select","mb-3"],["selected","","disabled",""],["value","Deposit"],["value","Withdrawal"],["for","amount"],[1,"input-group","mb-3"],[1,"input-group-text","fw-bold"],["formControlName","amount","id","amount","type","number","min","0",1,"form-control"],["for","transaction_date"],["formControlName","transaction_date","id","transaction_date","type","date",1,"form-control","mb-3"],["for","description"],["formControlName","description","id","description","rows","3",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"]],template:function(t,o){if(t&1){let r=b();i(0,"div",2,0)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h1",6),a(6,"Add Saving Transaction"),n(),i(7,"button",7),u("click",function(){return g(r),v(o.closeModal())}),n()(),i(8,"div",8)(9,"form",9)(10,"label",10),a(11,"Transaction Type"),n(),i(12,"select",11)(13,"option",12),a(14,"-- Select Transaction Type --"),n(),i(15,"option",13),a(16,"Deposit"),n(),i(17,"option",14),a(18,"Withdrawal"),n()(),i(19,"label",15),a(20,"Amount"),n(),i(21,"div",16)(22,"span",17),a(23,"\u20B1"),n(),_(24,"input",18),n(),i(25,"label",19),a(26,"Transaction Date"),n(),_(27,"input",20),i(28,"label",21),a(29,"Description"),n(),_(30,"textarea",22),n()(),i(31,"div",23)(32,"button",24),u("click",function(){return g(r),v(o.closeModal())}),a(33," Close "),n(),i(34,"button",25),u("click",function(){return g(r),v(o.addSavingTransaction())}),a(35,"Add Transaction"),n()()()()(),i(36,"button",26,1),u("click",function(){return g(r),v(o.openModal())}),a(38,` Add Saving Transaction
`),n()}t&2&&(c(9),S("formGroup",o.transactionForm))},dependencies:[G,A,q,B,V,F,U,N,k,P,R,H],encapsulation:2})};var lt=["updateSavingTransactionModal"],mt=["openUpdateSavingTransactionModalBtn"],Y=class s{updateSavingTransactionModal;openUpdateSavingTransactionModalBtn;transactionForm;formBuilder=p(L);activatedRoute=p(w);historyService=p(f);transactionsLength=E(0);updatedTransaction=O();tempUserId=m(1);savingId=m(1);transactionId=E(0);date=m(new Date().toISOString().split("T")[0]);constructor(){this.transactionForm=this.formBuilder.group({transaction_id:[""],saving_id:[""],user_id:[""],amount:[0,{validators:[d.required]}],savings_action:["",{validators:[d.required]}],transaction_date:["",{validators:[d.required]}],description:[""],created_at:["",{validators:[d.required]}],updated_at:["",{validators:[d.required]}],deleted_at:[""]})}ngOnInit(){let e=this.transactionId(),t=this.activatedRoute.snapshot.paramMap.get("id")??"";this.savingId.set(+t),this.transactionForm=this.formBuilder.group({transaction_id:[e],savings_id:[+t],user_id:[this.tempUserId()],amount:[0,{validators:[d.required]}],savings_action:["",{validators:[d.required]}],transaction_date:["",{validators:[d.required]}],description:[""],created_at:["",{validators:[d.required]}],updated_at:["",{validators:[d.required]}],deleted_at:[""]})}openModal(){new C(this.updateSavingTransactionModal.nativeElement).show()}closeModal(){C.getInstance(this.updateSavingTransactionModal.nativeElement)?.hide(),this.transactionForm.reset(),this.openUpdateSavingTransactionModalBtn.nativeElement.focus()}openUpdateModalWithData(){this.transactionId()&&(this.openModal(),this.historyService.getSavingTransactionsBySavingId(this.savingId(),this.transactionId()).subscribe(e=>{if(e.length===0)return;let t=e[0];this.transactionForm.setValue({transaction_id:t.transaction_id,savings_id:t.savings_id,user_id:t.user_id,amount:t.amount,savings_action:t.savings_action,transaction_date:t.transaction_date,description:t.description,created_at:t.created_at,updated_at:this.date(),deleted_at:t.deleted_at})}))}updateTransaction(){this.historyService.updateSavingTransaction(this.savingId(),this.transactionId(),this.transactionForm.value).subscribe(e=>{this.updatedTransaction.emit(e),this.closeModal()})}static \u0275fac=function(t){return new(t||s)};static \u0275cmp=h({type:s,selectors:[["app-update-saving-transaction"]],viewQuery:function(t,o){if(t&1&&(x(lt,5),x(mt,5)),t&2){let r;y(r=I())&&(o.updateSavingTransactionModal=r.first),y(r=I())&&(o.openUpdateSavingTransactionModalBtn=r.first)}},inputs:{transactionsLength:[1,"transactionsLength"],transactionId:[1,"transactionId"]},outputs:{updatedTransaction:"updatedTransaction"},decls:39,vars:1,consts:[["updateSavingTransactionModal",""],["openUpdateSavingTransactionModalBtn",""],["data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title","fs-5"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],["for","savings_action"],["formControlName","savings_action","id","savings_action",1,"form-select","mb-3"],["selected","","disabled",""],["value","Deposit"],["value","Withdrawal"],["for","amount"],[1,"input-group","mb-3"],[1,"input-group-text","fw-bold"],["formControlName","amount","id","amount","type","number","min","0",1,"form-control"],["for","transaction_date"],["formControlName","transaction_date","id","transaction_date","type","date",1,"form-control","mb-3"],["for","description"],["formControlName","description","id","description","rows","3",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-sm","btn-warning",3,"click"]],template:function(t,o){if(t&1){let r=b();i(0,"div",2,0)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h1",6),a(6,"Update Saving Transaction"),n(),i(7,"button",7),u("click",function(){return g(r),v(o.closeModal())}),n()(),i(8,"div",8)(9,"form",9)(10,"label",10),a(11,"Transaction Type"),n(),i(12,"select",11)(13,"option",12),a(14,"-- Select Transaction Type --"),n(),i(15,"option",13),a(16,"Deposit"),n(),i(17,"option",14),a(18,"Withdrawal"),n()(),i(19,"label",15),a(20,"Amount"),n(),i(21,"div",16)(22,"span",17),a(23,"\u20B1"),n(),_(24,"input",18),n(),i(25,"label",19),a(26,"Transaction Date"),n(),_(27,"input",20),i(28,"label",21),a(29,"Description"),n(),_(30,"textarea",22),n()(),i(31,"div",23)(32,"button",24),u("click",function(){return g(r),v(o.closeModal())}),a(33," Close "),n(),i(34,"button",25),u("click",function(){return g(r),v(o.updateTransaction())}),a(35,"Update Transaction"),n()()()()(),i(36,"button",26,1),u("click",function(){return g(r),v(o.openUpdateModalWithData())}),a(38,` Edit
`),n()}t&2&&(c(9),S("formGroup",o.transactionForm))},dependencies:[G,A,q,B,V,F,U,N,k,P,R,H],encapsulation:2})};var ut=s=>["/savings/update-saving",s],pt=(s,e)=>e.transaction_id;function gt(s,e){s&1&&(i(0,"tr")(1,"td",17),a(2," No transaction history available. "),n()())}function vt(s,e){if(s&1){let t=b();i(0,"tr")(1,"td"),a(2),n(),i(3,"td"),a(4),n(),i(5,"td"),a(6),n(),i(7,"td",18)(8,"app-update-saving-transaction",19),u("updatedTransaction",function(r){g(t);let l=D(2);return v(l.onSavingsTransactionUpdated(r))}),n(),i(9,"button",7),u("click",function(){let r=g(t).$implicit,l=D(2);return v(l.deleteSavingsTransaction(r.transaction_id))}),a(10," Delete "),n()()()}if(s&2){let t=e.$implicit;c(2),M(t.transaction_date),c(2),M(t.savings_action),c(2),$("$",t.amount.toFixed(2)),c(2),S("transactionId",t.transaction_id)}}function _t(s,e){if(s&1&&K(0,vt,11,4,"tr",null,pt),s&2){let t=D();X(t.filteredTransactions())}}var rt=class s{transactionHistories=m([]);filteredTransactions=m([]);transactionsCount=m(0);currentSaving=m({});historyService=p(f);savingService=p(at);activatedRoute=p(w);router=p(tt);savingId=m(1);ngOnInit(){let e=this.activatedRoute.snapshot.paramMap.get("id")??"";if(this.savingId.set(+e),!e||isNaN(+e)){this.router.navigate(["/savings"]);return}this.getSavingsTransactionHistories(),this.filterTransactions(),this.getSavingsData()}getSavingsTransactionHistories(){this.historyService.getStaticHistory().subscribe(e=>{this.transactionHistories.set(e),this.transactionsCount.set(e.length)})}filterTransactions(){let e=this.transactionHistories().filter(t=>t.savings_id===this.savingId());this.filteredTransactions.set(e)}getSavingsData(){let e=this.savingId();e&&this.savingService.getSavingById(e).subscribe(t=>{this.currentSaving.set(t)})}deleteSaving(){this.savingService.deleteSaving(this.savingId()).subscribe(()=>{this.router.navigate(["/savings"])})}deleteSavingsTransaction(e){this.historyService.deleteSavingTransaction(this.savingId(),e).subscribe(()=>{let t=this.transactionHistories().filter(o=>o.transaction_id!==e);this.transactionHistories.set(t),this.filterTransactions()})}onSavingsTransactionAdded(e){let t=[...this.transactionHistories(),e];this.transactionHistories.set(t),this.transactionsCount.set(t.length),this.filterTransactions()}onSavingsTransactionUpdated(e){let t=this.transactionHistories().map(o=>o.transaction_id===e.transaction_id?e:o);this.transactionHistories.set(t),this.filterTransactions()}static \u0275fac=function(t){return new(t||s)};static \u0275cmp=h({type:s,selectors:[["app-view-saving"]],decls:53,vars:10,consts:[[1,"card"],[1,"card-header","bg-dark","text-white"],[1,"card-body"],[1,"mh-3"],[1,"card-footer","d-flex","gap-2"],["type","button","routerLink","/savings",1,"btn","btn-sm","btn-secondary"],["type","button",1,"btn","btn-sm","btn-warning",3,"routerLink"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"],[1,"mt-5"],[1,"history-container"],[1,"header-container"],[1,"title"],[1,"action-container"],[3,"addedTransaction","transactionsLength"],[1,"table-container"],[1,"table","table-striped"],[1,"table-dark"],["colspan","4",1,"text-center"],[1,"d-flex","gap-1","justify-content-center","actions"],[3,"updatedTransaction","transactionId"]],template:function(t,o){t&1&&(_(0,"app-sidebar")(1,"app-header"),i(2,"main")(3,"div",0)(4,"div",1)(5,"h4"),a(6),n()(),i(7,"div",2)(8,"div",3)(9,"h5"),a(10,"Target Amount:"),n(),i(11,"span"),a(12),n()(),i(13,"div",3)(14,"h5"),a(15,"Frequency:"),n(),i(16,"span"),a(17),n()(),i(18,"div",3)(19,"h5"),a(20,"Goal Date:"),n(),i(21,"span"),a(22),n()()(),i(23,"div",4)(24,"button",5),a(25," Back to Savings "),n(),i(26,"button",6),a(27," Edit Saving "),n(),i(28,"button",7),u("click",function(){return o.deleteSaving()}),a(29," Delete Saving "),n()()(),i(30,"div",8)(31,"div",9)(32,"div",10)(33,"div",11)(34,"h4"),a(35,"History"),n()(),i(36,"div",12)(37,"app-add-saving-transaction",13),u("addedTransaction",function(l){return o.onSavingsTransactionAdded(l)}),n()()(),i(38,"div",14)(39,"table",15)(40,"thead")(41,"tr",16)(42,"th"),a(43,"Date"),n(),i(44,"th"),a(45,"Type"),n(),i(46,"th"),a(47,"Amount"),n(),i(48,"th"),a(49,"Actions"),n()()(),i(50,"tbody"),W(51,gt,3,0,"tr"),W(52,_t,2,0),n()()()()()()),t&2&&(c(6),M(o.currentSaving().name),c(6),$("$",o.currentSaving().target_amount.toFixed(2)),c(5),M(o.currentSaving().frequency),c(5),M(o.currentSaving().goal_date),c(4),S("routerLink",Z(8,ut,o.savingId())),c(11),S("transactionsLength",o.transactionsCount()),c(14),j(o.filteredTransactions().length===0?51:-1),c(),j(o.filteredTransactions().length>0?52:-1))},dependencies:[nt,it,et,Q,Y],styles:["main[_ngcontent-%COMP%]{margin-left:100px;background-color:#e8e9eb;padding:70px;height:auto;min-height:100vh}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:20px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:2em;align-items:center;padding:20px}.history-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.header-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}@media (max-width: 320px){main[_ngcontent-%COMP%]{margin-left:0;padding:10px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{flex-direction:column;gap:1em}.header-container[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:10px}.actions[_ngcontent-%COMP%]{flex-direction:column;gap:10px}}@media (min-width: 321px) and (max-width: 426px){main[_ngcontent-%COMP%]{margin-left:0;padding:10px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{flex-direction:column;gap:1em}.header-container[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:10px}.actions[_ngcontent-%COMP%]{flex-direction:column;gap:10px}}@media (min-width: 427px) and (max-width: 768px){main[_ngcontent-%COMP%]{margin-left:0;padding:10px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{flex-direction:column;gap:1em}.header-container[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:10px}.actions[_ngcontent-%COMP%]{flex-direction:row;gap:10px}}"]})};export{rt as ViewSaving};
